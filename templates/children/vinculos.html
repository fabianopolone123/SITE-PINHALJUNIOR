{% extends "base.html" %}
{% block title %}V칤nculos{% endblock %}
{% block menu %}
    <a href="{% url 'dashboard' %}">游 In칤cio</a>
    <a href="{% url 'children-list' %}">游 Aventureiros</a>
    <a href="{% url 'children-vinculos' %}">游댕 V칤nculos</a>
    <a href="{% url 'logout' %}">Sair</a>
{% endblock %}
{% block content %}
<div class="card">
    <div class="chip">V칤nculos de Respons치veis</div>
    <form method="get" style="margin-bottom:14px; display:grid; gap:10px; max-width:640px;">
        <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap:10px;">
            <label>Aventureiro
                <input type="text" name="child" value="{{ child_query }}" placeholder="Buscar por nome">
            </label>
            <label>Respons치vel
                <input type="text" name="guardian" value="{{ guardian_query }}" placeholder="Nome ou WhatsApp">
            </label>
            <label>V칤nculo
                <select name="relationship">
                    <option value="">Todos</option>
                    <option value="Pai/M칚e" {% if relationship_query == 'Pai/M칚e' %}selected{% endif %}>Pai/M칚e</option>
                    <option value="Respons치vel" {% if relationship_query == 'Respons치vel' %}selected{% endif %}>Respons치vel</option>
                    <option value="Av칪/Av칩" {% if relationship_query == 'Av칪/Av칩' %}selected{% endif %}>Av칪/Av칩</option>
                    <option value="Tio/Tia" {% if relationship_query == 'Tio/Tia' %}selected{% endif %}>Tio/Tia</option>
                    <option value="Irm칚o/Irm칚" {% if relationship_query == 'Irm칚o/Irm칚' %}selected{% endif %}>Irm칚o/Irm칚</option>
                </select>
            </label>
        </div>
        <div>
            <button type="submit" style="padding:10px 14px; border:none; border-radius:10px; background:#0ea5e9; color:#fff; font-weight:800; margin-right:6px;">Filtrar</button>
            <a href="{% url 'children-vinculos' %}" style="padding:10px 12px; border-radius:10px; background:#e2e8f0; color:#0f172a; text-decoration:none; font-weight:700;">Limpar</a>
        </div>
    </form>
    <form method="post" style="margin-bottom:20px;">
        {% csrf_token %}
        <div style="display:grid; gap:10px; max-width:520px;">
            {{ form.as_p }}
            <button type="submit" style="padding:12px 14px; border:none; border-radius:12px; background:linear-gradient(90deg,#0ea5e9,#22d3ee); color:#fff; font-weight:800;">Adicionar v칤nculo</button>
        </div>
    </form>
    <table style="width:100%; border-collapse: collapse; border-radius:10px; overflow:hidden; border:1px solid #e2e8f0;">
        <thead style="background:#2563eb; color:#fff;">
            <tr style="text-align:left;">
                <th style="padding:10px 12px;">Aventureiro</th>
                <th style="padding:10px 12px;">Respons치vel</th>
                <th style="padding:10px 12px;">V칤nculo</th>
            </tr>
        </thead>
        <tbody>
            {% for link in guardian_links %}
            <tr style="border-top:1px solid #e2e8f0;">
                <td style="padding:10px 12px;">{{ link.child.name }}</td>
                <td style="padding:10px 12px;">{{ link.guardian_user.full_name|default:link.guardian_user.whatsapp_number }}</td>
                <td style="padding:10px 12px;">{{ link.relationship }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="3" style="padding:10px 12px;">Nenhum v칤nculo cadastrado.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
